/*function doUpload() {    //var formdata=new FormData($("#form1").[0]);//获取文件法一    var formdata=new FormData( );    formdata.append("file" , $("#orderFile")[0].files[0]);//获取文件法二    //var formData = new FormData($( "#uploadForm" )[1]);    $.ajax({        url: "/orderFile/" ,        type: "POST",        data: formdata,        async: false,        cache: false,        processData: false,  // 告诉jQuery不要去处理发送的数据        contentType: false,  // 告诉jQuery不要去设置Content-Type请求头        success: function (returndata) {            alert(returndata);        },        error: function (returndata) {            alert(returndata);        }    });//}*//*添加*///销售添加orderfunction confirmAddOrder(orderName,partyA,deliveryTime,remark){    var index = "";    $.ajax({        url : "/order/",        type : "POST",        data : {            orderName:orderName,            partyA:partyA,            deliveryTime:deliveryTime,            remark:remark        },        beforeSend:function () {            index = layer.msg('添加中...', {icon: 16,time: 20000,shade:0.01});        },        success : function(data) {            $("#addOrderDiv").modal("hide");            layer.close(index);            $("#userJson").bootstrapTable("refresh");            layer.alert(data);        },        error : function(data) {            alert(data.status);        }    });}//销售添加order前  验证orderName是否存在function addOrder(){    /*名称，学校，交货时间，备注*/   var orderName = $("#orderName").val().replace(/(?:^\s*)|(?:\s*$)/g, "");   var partyA = $("#partyA").val().replace(/(?:^\s*)|(?:\s*$)/g, "");   var deliveryTime = $("#deliveryTime").val().replace(/(?:^\s*)|(?:\s*$)/g, "");   var remark = $("#remark").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    if(orderName==""){        layer.msg("订单名称不能为空，请填写");        return ;    }    if(partyA==""){        layer.msg("学校名称不能为空，请填写");        return ;    }    if(deliveryTime==""){        layer.msg("交货时间不能为空，请填写");        return ;    }   //验证orderName是否存在    $.ajax({        url : "/order?method=findOrderByName&orderName="+orderName,        success : function(data) {            if(data=="1"){                layer.msg("订单名称已经存在，请修改订单");            }else{                confirmAddOrder(orderName,partyA,deliveryTime,remark);                /*var orderId = $("#orderId").val();                // alert('/order/'+orderId)                $('#ff').attr('action','/order/');                $('#ff').submit();*/            }        },        error : function(data) {            alert(data.status);        }    });}/*销售添加订单表   TODO  1_15???  statu==1 */$('#userJson').bootstrapTable({    url: '/order/?orderStatu=1',//状态为1是销售状态，15为收货状态    method : "GET",    search:true,//搜索框    uniqueId:'id',//主键列    pagination:true,//启用分页    paginationLoop:false,//页码循环    sidePagination:'client',//客户端分页    pageSize:10,    pageList:[5,10,15,20],    //sortName:'id',//自定义排序列    //sortOrder:'desc',//倒序    showColumns:true,//选择显示columns    //detailView:true,//详细页面模式    toolbar:'#toolbar',//指定工具栏    undefinedText:'-',//undefined时显示字符    smartDisplay:true,//智能切换视图    maintainSelected:true,//切换页面记录选中的按钮    singleSelect:true,//禁止多选    clickToSelect:true,//点击行时选中    //cardView:true,//手机端视图    //showPaginationSwitch:true,    //showHeader:true,//显示表头    //showFooter:true,//显示表尾    selectItemName:'btSelectItem',//	radio or checkbox 的字段名    detailView:true,//显示子父表    responseHandler: function(result) {        return result;    },    columns: [{        checkbox: true,        title: '删除',    }, {        field: 'orderName',        title: '订单名称',    }, {        field: 'id',        title: '订单id',    }, {        field: 'partyA',        title: '学校'    }, {        field: 'userName',        title: '销售姓名'    }, {        field: 'remark',        title: '备注'    } , {        field: 'deliveryTime',        title: '交货时间'    }, {        field: 'id',        title: '操作',        formatter:function (value, row, index){            var htmlStr = "<button type='button'class='btn-sm' onclick=\"openChangeOrderDiv('"+row.orderName+"','"+row.partyA+"','"+row.deliveryTime+"','"+row.remark+"','"+row.id+"')\">修改订单</button>"            +"&nbsp;<button type='button' class='btn-sm' onclick=\"submitOrder('"+row.id+"')\">提交订单</button>";            return htmlStr;//获取按钮        }    }],    //注册加载子表的事件。注意下这里的三个参数！    onExpandRow: function (index, row, $detail) {        childTable(index, row, $detail);    },});//订单配置表  子表var childTable = function (index, row, $detail) {    var orderId = row.id;    cur_table = $detail.html('<table></table>').find('table');    $(cur_table).bootstrapTable({        url: 'order/infos/'+orderId,        method: 'get',        //处理数据返回        responseHandler: function(result) {            return result;        },        columns: [{            field: 'orderid',            title: "<button onclick='addInfo("+orderId+            ");' type='button' class='btn btn-sm btn-info'><span class='glyphicon glyphicon-plus' aria-hidden='true'></span>添加配置</button>",            formatter: function (value, row, index) {                return index+1;            }        }, {            field: 'infoName',            title: '配置名称',        }, {            field: 'fabric',            title: '面料',            formatter: function (value, row, index) {                var tempHtml = "";                var fabricArr = eval(value);                if(fabricArr!=null&&fabricArr.length>0){                    for(var i = 0; i<fabricArr.length; i++){                        tempHtml += fabricArr[i].name +":"+ fabricArr[i].color+"，&nbsp;";                    }                }                return tempHtml;            }        }, {            field: 'style',            title: '款式'        }, {            field: 'gongyi',            title: '工艺'        }, {            field: 'giveKH',            title: '客户有无样衣'        }, {            field: 'containFabric',            title: '含量'        }, {            field: 'logoStation',            title: '校徽位置'        }, {            field: 'total',            title: '总数'        }, {            field: 'id',            title: '操作',            formatter:function (value, row, index) {                var strTemp = "<button type='button' class='btn btn-info btn-sm' onclick='deleteInfo("+value+")'>"                    +"删除配置</button>"                +"&nbsp;<button type='button' class='btn btn-info btn-sm' onclick='findOrderInfo("+value+")'>"                +"查看详情</button>"                    +"&nbsp;<button type='button' class='btn btn-info btn-sm' onclick='editInfo("+value+")'>"                    +"修改配置</button>"                ;                return strTemp;            }        }],    });};/*修改配置页面*/function editInfo(infoId){    window.open('/orderInfo/edit/'+infoId);    //window.location.href = '/orderInfo/edit/'+infoId;}/*删除配置*/function deleteInfo(infoId) {    layer.msg('确认删除配置？', {        time: 0 //不自动关闭        ,shade:0.01        ,btn: ['删除', '取消']        ,yes: function(index){            layer.close(index);            jQuery.ajax({                url : "/orderInfo/"+infoId,                type : "DELETE",                beforeSend:function(){                    index = layer.msg('删除中...', {icon: 16,time: 20000,shade:0.01});                },                success : function(data) {                    layer.close(index);                    layer.msg(data);                    $("#userJson").bootstrapTable('refresh');                },                error : function(data) {                    layer.msg(data.status);                    //$( '#serverResponse').html(data.status + " : " + data.statusText + " : " + data.responseText);                }            });        }    });}/*添加配置  页面*///订单添加配置信息 info  layer.open详情页function addInfo(orderId){    /*var index = layer.open({        type: 2,        content: '/orderDetail/'+orderId,        maxmin: true,        end:function () {            $('#userJson').bootstrapTable("refresh");        }    });    layer.full(index);*/    //window.open('/orderDetail/'+orderId);    window.location.href = '/orderDetail/'+orderId;}//TODO  不晓得有什么用function addfile(){ 	var size=$("#filesize").val(); 	size=parseInt(size)+1; 	var html='<p id="file_p'+size+'"><span class="span-z"><label>文件'+size+':</label><input name="orderFile" type="file" multiple="multiple"></span></p>' 	$("#filesize").val(size); 	if(size==1){		$("#file_p").after(html);	}else{		size=parseInt(size)-1;		$("#file_p"+size).after(html);	}}/*日期插件*/$('#deliveryTime,#changeDeliveryTime').daterangepicker({    singleDatePicker: true,    minDate:new Date(),    locale: {        format: 'YYYY-MM-DD',        daysOfWeek : [ '日', '一', '二', '三', '四', '五', '六' ],        monthNames : [ '一月', '二月', '三月', '四月', '五月', '六月',            '七月', '八月', '九月', '十月', '十一月', '十二月' ],    }});/*销售确认提交订单到工艺  确认  statu==2*/function submitOrder(orderId) {    layer.msg('确认提交订单？', {        time: 0 //不自动关闭        ,shade:0.01        ,btn: ['提交', '取消']        ,yes: function(index){            layer.close(index);            jQuery.ajax({                url : "order/submitOrder",                type : "POST",                data:{orderId:orderId},                beforeSend:function(){                    index = layer.msg('提交中...', {icon: 16,time: 20000,shade:0.01});                },                success : function(data) {                    layer.close(index);                    layer.msg(data);                    $("#userJson").bootstrapTable('refresh');                },                error : function(data) {                    layer.msg(data.status);                    //$( '#serverResponse').html(data.status + " : " + data.statusText + " : " + data.responseText);                }            });        }    });}/*弹出div*///添加订单弹出orderdivfunction openAddOrderDiv() {    $("#addOrderDiv").modal("show");}//修改订单弹出orderdivfunction openChangeOrderDiv(orderName,partyA,deliveryTime,remark,orderId){    $("#changeOrderName").val(orderName);    $("#changePartyA").val(partyA);    $("#changeDeliveryTime").val(deliveryTime);    $("#changeRemark").val(remark);    $("#changeOrderId").val(orderId);    $("#changeOrderDiv").modal("show");}/*修改*///销售  更改订单前  验证orderName是否还有别的订单存在function changeOrder() {    /*名称，学校，交货时间，备注*/    var orderName = $("#changeOrderName").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    var partyA = $("#changePartyA").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    var deliveryTime = $("#changeDeliveryTime").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    var remark = $("#changeRemark").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    var orderId = $("#changeOrderId").val().replace(/(?:^\s*)|(?:\s*$)/g, "");    if(orderName==""){        layer.msg("订单名称不能为空，请填写");        return ;    }    if(partyA==""){        layer.msg("学校名称不能为空，请填写");        return ;    }    if(deliveryTime==""){        layer.msg("交货时间不能为空，请填写");        return ;    }    //验证orderName是否存在    $.ajax({        url : "/order?method=findOrderByName",        data:{            orderName:orderName,            orderId:orderId        },        success : function(data) {            if(data=="1"){                layer.msg("订单名称已经存在，请修改订单");            }else{                confirmChangeOrder(orderName,partyA,deliveryTime,remark,orderId);                /*var orderId = $("#orderId").val();                // alert('/order/'+orderId)                $('#ff').attr('action','/order/');                $('#ff').submit();*/            }        },        error : function(data) {            alert(data.status);        }    });}//销售修改orderfunction confirmChangeOrder(orderName,partyA,deliveryTime,remark,orderId){    var index = "";    $.ajax({        url : "/order/",        type : "POST",        data : {            orderName:orderName,            partyA:partyA,            deliveryTime:deliveryTime,            remark:remark,            orderId:orderId        },        beforeSend:function () {            index = layer.msg('修改中...', {icon: 16,time: 20000,shade:0.01});        },        success : function(data) {            $("#changeOrderDiv").modal("hide");            layer.close(index);            $("#userJson").bootstrapTable("refresh");            layer.alert(data);        },        error : function(data) {            alert(data.status);        }    });}/*删除*///删除订单function removeOrder(){    var orders = $("#userJson").bootstrapTable('getSelections');    if(orders.length<1){        layer.msg("请选择订单");        return;    }    var orderId = orders[0].id;    layer.msg('确认删除订单？', {        time: 0 //不自动关闭        ,shade:0.01        ,btn: ['提交', '取消']        ,yes: function(index){            layer.close(index);            jQuery.ajax({                url : "order/"+orderId,                type : "DELETE",                beforeSend:function(){                    index = layer.msg('删除中...', {icon: 16,time: 20000,shade:0.01});                },                success : function(data) {                    layer.close(index);                    layer.msg(data);                    $("#userJson").bootstrapTable('refresh');                },                error : function(data) {                    layer.msg(data.status);                    //$( '#serverResponse').html(data.status + " : " + data.statusText + " : " + data.responseText);                }            });        }    });}/*查看详情*/function findOrderInfo(infoId){    window.open('/orderDetail/info/'+infoId);}