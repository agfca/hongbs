//工艺订单表   statu==2_5$('#userJson').bootstrapTable({    url: '/order/?orderStatu='+level, // 生产安排，后勤主管，后勤销售主管    method : "GET",    search:true,//搜索框    uniqueId:'id',//主键列    pagination:true,//启用分页    paginationLoop:false,//页码循环    sidePagination:'client',//客户端分页    pageSize:10,    pageList:[5,10,15,20],    //sortName:'id',//自定义排序列    //sortOrder:'desc',//倒序    showColumns:true,//选择显示columns    //detailView:true,//详细页面模式    toolbar:'#toolbar',//指定工具栏    undefinedText:'-',//undefined时显示字符    smartDisplay:true,//智能切换视图    maintainSelected:true,//切换页面记录选中的按钮    //singleSelect:true,//禁止多选    clickToSelect:true,//点击行时选中    //cardView:true,//手机端视图    //showPaginationSwitch:true,    //showHeader:true,//显示表头    //showFooter:true,//显示表尾    selectItemName:'btSelectItem',//	radio or checkbox 的字段名    detailView:true,//显示子父表    // 处理数据返回    responseHandler: function(result) {        return result;    },    columns: [{        field: 'orderName',        title: '订单名称',    }, {        field: 'oddNum',        title: '单号'    }, {        field: 'partyA',        title: '甲方'    }, {        field: 'userName',        title: '销售'    }, {        field: 'fileName',        title: '下单人'    }, {        field: 'orderTime',        title: '下单时间'    }, {        field: 'orderStatu',        title: '订单状态',        formatter: function (value, row, index) {            return getOrderStatu(value);        }    }, {        field: 'deliveryTime',        title: '交货时间'    }, {        field: 'remark',        title: '备注'    }, {        field: 'id',        title: '操作',        formatter:function (value, row, index){            return getButton(row);        }    }],    //注册加载子表的事件。注意下这里的三个参数！    onExpandRow: function (index, row, $detail) {        childTable(index, row, $detail);    },});//订单配置表  子表var childTable = function (index, row, $detail) {    var orderId = row.id;    cur_table = $detail.html('<table></table>').find('table');    $(cur_table).bootstrapTable({        url: 'order/infos/'+orderId,        method: 'get',        //处理数据返回        responseHandler: function(result) {            return result;        },        columns: [{            field: 'orderid',            title: "序号",            formatter: function (value, row, index) {                return index+1;            }        }, {            field: 'infoName',            title: '配置名称',        }, {            field: 'fabric',            title: '面料',            formatter: function (value, row, index) {                var tempHtml = "";                var fabricArr = eval(value);                if(fabricArr!=null&&fabricArr.length>0){                    for(var i = 0; i<fabricArr.length; i++){                        tempHtml += fabricArr[i].name +":"+ fabricArr[i].color+"，&nbsp;";                    }                }                return tempHtml;            }        }, {            field: 'style',            title: '款式'        }, {            field: 'gongyi',            title: '工艺'        }, {            field: 'giveKH',            title: '客户有无样衣'        }, {            field: 'containFabric',            title: '含量'        }, {            field: 'logoStation',            title: '校徽位置'        }, {            field: 'total',            title: '总数'        }, {            field: 'id',            title: '操作',            formatter:function (value, row, index) {                var strTemp ="<button type='button' class='btn btn-info btn-sm' onclick='findOrderInfo("+value+")'>"                    +"查看详情</button>";                return strTemp;            }        }],    });};//工艺核对销售完毕function putOrder1(orderId){    layer.msg('确认核对完毕？', {        time: 0 //不自动关闭        ,btn: ['确认', '取消']        ,yes: function(index){            layer.close(index);            $.ajax({                url : "/order/"+orderId+"",                type : "PUT",                data : {orderStatu:3},                success : function(data) {                    layer.msg(data);                    $("#userJson").bootstrapTable("refresh");                },                error : function(data) {                    alert(data.status);                }            });        }    });}//工艺核对制版完毕function putOrder2(orderId){    layer.msg('确认核对完毕？', {        time: 0 //不自动关闭        ,btn: ['确认', '取消']        ,yes: function(index){            layer.close(index);            $.ajax({                url : "/order/"+orderId+"",                type : "PUT",                data : {orderStatu:6},                success : function(data) {                    layer.msg(data);                    $("#userJson").bootstrapTable("refresh");                },                error : function(data) {                    alert(data.status);                }            });        }    });}/*操作按钮*/function getButton(row){    //return "<button type='button' class='btn btn-info btn-sm' onclick=\"putOrder("+row.id+")\">核对销售完毕</button>"    var htmlStr = "";    if(row.orderStatu==2){        htmlStr +=  "&nbsp;<button type='button' class='btn-sm' onclick=\"putOrder1("+row.id+")\">核对销售完毕</button>";    }    if(row.orderStatu==5){        if(row.material==1){//有材料计划单            htmlStr += "<button type='button' class='btn-sm' onclick=\"editOrderMaterial('"+row.id+"')\">修改材料计划单</button>";            htmlStr +=  "&nbsp;<button type='button' class='btn-sm' onclick=\"putOrder2("+row.id+")\">核对制版完毕</button>";        }else{            htmlStr += "<button type='button' class='btn-sm' onclick=\"addOrderMaterial('"+row.id+"')\">添加材料计划单</button>";        }    }    return htmlStr;//获取按钮}/*查看配置详情*/function findOrderInfo(infoId){    window.open('/orderDetail/info/'+infoId);}/*获取制版文件*/function getFile(orderId,filePath) {    window.open("/word/"+orderId+"/"+filePath);}/*打开添加材料计划单页面*/function addOrderMaterial(orderId){    //window.open("/orderMaterial/"+orderId);    window.location.href = "/orderMaterial/"+orderId;}/*打开修改材料计划单页面*/function editOrderMaterial(orderId){    //window.open("/orderMaterial/edit/"+orderId);    window.location.href = "/orderMaterial/edit/"+orderId;}/*function putOrder(orderId,orderStatu,oddNum){    if(orderStatu=="5"){//提交的时候 ，如果步骤到了第5部，必须先上传材料计划单        $.ajax({            url : "/order/"+oddNum+"",            type : "GET",            success : function(data) {                if(data.file2Name==""||data.file2Name==null||data.file2Name=="null"){                    alert("请上传材料计划单...");                    return;                }else{                    $.ajax({                        url : "/order/"+orderId+"",                        type : "PUT",                        data : {orderStatu:6},                        success : function(data) {                            alert(data);                            $("#userJson").bootstrapTable("refresh");                        },                        error : function(data) {                            alert(data.status);                            //$( '#serverResponse').html(data.status + " : " + data.statusText + " : " + data.responseText);                        }                    });                }            },            error : function(data) {                return;            }        });    }else{        $.ajax({            url : "/order/"+orderId+"",            type : "PUT",            data : {orderStatu:3},            success : function(data) {                alert(data);                $("#userJson").bootstrapTable("refresh");            },            error : function(data) {                alert(data.status);                //$( '#serverResponse').html(data.status + " : " + data.statusText + " : " + data.responseText);            }        });    }}*//*function returnOrder(orderId,orderStatu){    var orderStatu = parseInt(orderStatu)-1;    $.ajax({        url : "/order/"+orderId+"",        type : "PUT",        data : {orderStatu:orderStatu},        success : function(data) {            alert(data);            $("#userJson").bootstrapTable("refresh");        },        error : function(data) {            alert(data.status);        }    });}*//*function change(id,orderName,oddNum,modelFile,file2Name){    $("#id").val(id);    $("#orderName").val(orderName);    $("#oddNum").val(oddNum);    $("#modelFile").val(modelFile);    $("#file2Name").val(file2Name);}*//*function changerOrder(){    var file2Name = $("#file2Name").val().replace(/(^\s*)|(\s*$)/g, "");    var modelFile = $("#modelFile").val().replace(/(^\s*)|(\s*$)/g, "");    if(file2Name==""){        alert("请上传材料计划单");        return ;    }    $('#ff').attr('action','/order?method=findOrderFile');    $('#ff').submit( );}*/